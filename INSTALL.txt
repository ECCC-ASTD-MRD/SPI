Installation procedures
-----------------------

Documentation:
   - Application and librairie documentation can be found on the CMC wiki at https://wiki.cmc.ec.gc.ca/wiki/SPI/Doc
   - Example scripts and macro are available in the share/examples directory of your SPI installation path

System requirements:

   - Hardware:

        Any Intel/AMD processor
        2G ram
        32Mb Graphic card (NVIDIA por favor)
        3G Disk space (For installation)

   - Software:

        Provided with the package:
           tcl8.6.6            (Tcl)
           tk8.6.6             (Tk)
           Tcllib-1.18         (Tcl librarie of tools)
           Tktable2.10         (Tk table extension)
           tcltls-1.7.12       (Tcl OpenSSL bindings)
           tdom-master         (Tcl DOM esxtension)
           tkdnd2.8            (Tk drag'n drop extension)
           tkimg1.4.6          (Tk image extension)
           mesa-7.9.2          (Mesa software OpenGL implementation)
           gdb                 (ECCC vectorial basemap)
    
        Not provided with the package but available through packaging tools (apt-get):
     
           Mandatory:
              GLX ou mesa-dev     (OpenGL software implementation    https://www.mesa3d.org)
              gdal-dev            (Geospatial Data Abstraction Layer https://gdal.org)
              bison               (parser generator                  https://www.gnu.org/software/bison)
              flex                (lexical analyzer generator        https://www.gnu.org/software/flex)
              rmnlib-16.3         (RPN file format support           https://github.com/armnlib/librmn)
              ImageMagik          (For image output                  https://www.imagemagick.org/script/index.php)
      
           Optional:
              vgrid               (Vertical grid management          https://gitlab.com/ECCC_CMDN/vgrid)
              libeccodes          (GRIB support                      https://launchpad.net/ubuntu/+source/eccodes)
              libecbufr           (BUFR and BURP support             https://launchpad.net/libecbufr)
              liburp              (URP radar support)
              libflt              (OpenFlight support                https://sourceforge.net/projects/fltlib)
              Xvfb or Xorg xdummy (For batch mode                    https://launchpad.net/ubuntu/+source/xserver-xorg-driver-dummy)

       Make sure your graphic drivers are up to date for direct rendering (use glxinfo to confirm)

Installation:

   - DBGeo.tgz
       Geographical database (GDB), contains the base geographical data used by default by SPI.
       Decompressing it into it's final installation directory if it has'nt been installed before.
       This will take up to 13 Gig for the global coverage     
       
   - SPI-x.x.x.tgz
       SPI and it's dependencies. it contains 
       
          INSTALL.txt       : This file
          makeit            : Build and install script
          SPI_x.x.x         : The SPI application, the tcl part of SPI
          libSPI_x.x.x      : The SPI libraries to be compiled
          libeerUtils_x.x.x : Library of common functions and tools used by SPI
          GenPhysX_x.x.x    : GenphysX application
          ext               : External dependencies for SPI_LIB
          
       - Untar the tgz and change to the src directory.
       - Use the makeit script to build and install the package
          - If you want to build with vgrid, define the VGRID_PATH environment variable to the path where its lib/libdescrip.a resides.
          - Version 8.0.0 comes with a prebuilt librmn 16.3 as it's not published yet but contains needed fixes. If you want to use another version, change the libeerUtils_x.x.x/lib/librmn.so to point to it.
          - If you need to build with libeccodes,libecbufr or liburp, you will need to specify their location in the libSPI_x.x.x/makeit script (--with-ecbufr=,--with-eccodes=,--with-urp=).
       
            ./makeit -build
            ./makeit -install [install path]
       
      - After the installation you will be provided with some environment variables to define, which are describe bellow.
      
Environment:

   - The method of defining environment variables and the location to do so depends on your shell, the description thereafter suposes the use of sh/ksh/bash
   
   - Define the GDB_PATH variable to the location of the geographical database for SPI to use it:

        export GDB_PATH=[your geo_path]/data

   - Define the SPI_LIB variable to the location of the SPI librairies

        export SPI_LIB=[your libspi_path]
   
   - If you want to run scripts, you will have to define an environment variable pointing to the path
      where you installed SPI. Depending on the shell you are using, this might mean:

        export SPI_PATH=[your spi_path]

Executin SPI:

   - You can now launch SPI by calling 

         [your spi_path]/bin/SPI

      or

         $SPI_PATH/bin/SPI

      The first time you run it SPI will create a setup directory called .spi in
      your home directory where the parameters are saved. You can edit theses files, primarily
      the one called ~/.spi/SPI, carefully to configure SPI to your likings.
