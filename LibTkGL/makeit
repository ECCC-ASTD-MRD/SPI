#!/bin/sh

MAKE=make
INST=/users/dor/afsr/005
LIB=${INST}/lib/${BASE_ARCH}
INC=${INST}/include

export CC=c99

echo ""
echo "----- Architecture Found : ${BASE_ARCH} -----"
echo ""

echo ""
echo "----- Making System Call Library Object -----"
echo ""
export LDFLAGS="-L${LIB} -ldmv"
export CFLAGS="-D_GNU_SOURCE -DHAVE_DMV -I${INC} -I${INC}/dmv"  
cd TclSystem
./configure \
   --exec-prefix=${LIB}/TclTk \
   --enable-threads \
   --enable-64bit \
   --with-tcl=${LIB}/TclTk/lib

$MAKE install
ln -fs ${LIB}/TclTk/lib/TclSystem1.0/libTclSystem1.0.so ${LIB}/libTclSystem.so

echo ""
echo "----- Making OpenGL Canvas Library Object -----"
echo ""
export LDFLAGS="-L${LIB}"
export CFLAGS=""  
cd ../TkglCanvas
./configure \
   --prefix=${LIB}/TclTk/ \
   --exec-prefix=${LIB}/TclTk/ \
   --enable-threads \
   --enable-64bit \
   --with-tcl=${LIB}/TclTk/lib \
   --with-tk=${LIB}/TclTk/lib

$MAKE install
ln -fs ${LIB}/TclTk/lib/TkglCanvas8.6/libTkglCanvas8.6.so ${LIB}/libTkglCanvas.so

echo ""
echo "----- Making Tcl GeoEER Library Object -----"
echo ""
export LDFLAGS="-L${LIB}"
export CFLAGS="-D_GNU_SOURCE -DHAVE_GDB -DHAVE_RMN -DHAVE_GRIB -DHAVE_ECBUFR -DHAVE_FLT -DHAVE_GDAL -I${INC} -I${INC}/libeer -I${INC}/gdb -I${INC}/gdal -I${INC}/rmnlib -I${INC}/urp -I${INC}/grib_api -I${INC}/libecbufr -I${INC}/fltlib"  
cd ../TclGeoEER
./configure \
   --exec-prefix=${LIB}/TclTk \
   --enable-threads \
   --enable-64bit \
   --with-tcl=${LIB}/TclTk/lib \
   --with-tk=${LIB}/TclTk/lib

$MAKE install
ln -fs ${LIB}/TclTk/lib/TclGeoEER7.6.0/libTclGeoEER7.6.0.so ${LIB}/libTclGeoEER.so
